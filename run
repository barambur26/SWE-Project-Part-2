#!/usr/bin/env python3
from __future__ import annotations

import os
import sys
from pathlib import Path

# Add "<repo>/src" to the Python import path so "python -m swe_project.cli" works
ROOT = Path(__file__).resolve().parent
src_path = str(ROOT / "src")
os.environ["PYTHONPATH"] = f"{src_path}{os.pathsep}{os.environ.get('PYTHONPATH', '')}"

# Convenience: allow "./run URL_FILE" -> "./run score URL_FILE"
argv = sys.argv[1:]
if (
    len(argv) == 1
    and not argv[0].startswith("-")
    and argv[0] not in {"install", "test", "score"}
):
    p = Path(argv[0])
    if p.is_file() or p.suffix in {".txt", ""}:
        argv = ["score", argv[0]]

# Replace current process with "python -m swe_project.cli ..."
os.execv(sys.executable, [sys.executable, "-m", "swe_project.cli", *argv])
